<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ø³Ø§Ø¹Ø© ÙƒØ±Ø¨ÙˆÙ† Ø£Ø³ÙˆØ¯ â€” Ø£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ© | Ù…ØªØ¬Ø± AQRAB</title>
  <link rel="icon" type="image/x-icon" href="logo.ico">
   <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <script>
    // Ø¥Ø®ÙØ§Ø¡ ØªØ­Ø°ÙŠØ±Ø§Øª Tailwind CSS ÙÙŠ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„
    tailwind.config = {
      corePlugins: {
        preflight: false,
      }
    }
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

</head>

<body class="bg-white text-black font-sans">

  <!-- Ù‡ÙŠØ¯Ø± -->
  <header class="bg-white/90 backdrop-blur border-b border-black/10 sticky top-0 z-50">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <h1 class="text-xl font-bold tracking-tight">AQRAB</h1>
      <a href="track-order.html" class="text-sm text-gray-600 hover:text-black transition flex items-center gap-2 bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded-lg">
        <i class="fa-solid fa-truck"></i>
        ØªØªØ¨Ø¹ Ø§Ù„Ø·Ù„Ø¨
      </a>
    </div>
  </header>
<style>
  * {
    font-family: 'Cairo', sans-serif;
    box-sizing: border-box;
  }

  body {
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    min-height: 100vh;
  }

  .product-card {
    background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
    border: 1px solid #e2e8f0;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
  }

  .product-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
  }

  .btn-primary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    transition: all 0.3s ease;
  }

  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
  }

  .price-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 20px;
    padding: 2rem;
    color: white;
    box-shadow: 0 15px 35px rgba(102, 126, 234, 0.3);
  }
  /* Ø§Ù„ÙƒØ±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù…Ø© */
  #chat-ball {
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 60px;
    height: 60px;
    background: linear-gradient(45deg, #000000, #333333);
    border-radius: 50%;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 24px;
    z-index: 9999;
    transition: transform 0.2s ease;
  }

  #chat-ball:hover {
    transform: scale(1.1);
  }

  /* popup */
  #chat-popup {
    display: none;
    position: fixed;
    bottom: 100px;
    right: 30px;
    width: 350px;
    height: 500px;
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    z-index: 9998;
  }

  #chat-popup iframe {
    width: 100%;
    height: 100%;
    border: none;
  }

  /* Ø²Ø± Ø§ØºÙ„Ø§Ù‚ */
  #chat-close {
    position: absolute;
    top: 5px;
    right: 5px;
    background: red;
    color: white;
    border: none;
    border-radius: 50%;
    width: 25px;
    height: 25px;
    cursor: pointer;
    font-weight: bold;
    font-size: 16px;
    z-index: 10000;
  }
</style>

  <!-- Ø§Ù„Ù…Ù†ØªØ¬ -->
  <main class="max-w-7xl mx-auto px-4 py-8 lg:py-16">
    <div class="grid lg:grid-cols-2 gap-8 lg:gap-16 items-start">
    
      <!-- ØµÙˆØ± -->
      <div class="space-y-6">
        <div class="product-card rounded-3xl p-8 border border-gray-200">
          <img id="mainImage" src="images/4.jpg" alt="Ø³Ø§Ø¹Ø© ÙƒØ±Ø¨ÙˆÙ† Ø£Ø³ÙˆØ¯" class="w-full h-96 lg:h-[500px] object-cover rounded-2xl transition-transform duration-500 hover:scale-105">
        </div>
        <div class="grid grid-cols-4 gap-4">
          <img src="images/2.jpg" class="thumb h-20 lg:h-24 w-full object-cover rounded-xl border-2 border-gray-200 hover:border-purple-500 cursor-pointer transition-all duration-300 hover:scale-110 hover:shadow-lg">
          <img src="images/3.jpg" class="thumb h-20 lg:h-24 w-full object-cover rounded-xl border-2 border-gray-200 hover:border-purple-500 cursor-pointer transition-all duration-300 hover:scale-110 hover:shadow-lg">
          <img src="images/5.jpg" class="thumb h-20 lg:h-24 w-full object-cover rounded-xl border-2 border-gray-200 hover:border-purple-500 cursor-pointer transition-all duration-300 hover:scale-110 hover:shadow-lg">
          <img src="images/1.jpg" class="thumb h-20 lg:h-24 w-full object-cover rounded-xl border-2 border-gray-200 hover:border-purple-500 cursor-pointer transition-all duration-300 hover:scale-110 hover:shadow-lg">
        </div>
      </div>

      <!-- ØªÙØ§ØµÙŠÙ„ -->
      <div class="space-y-8 lg:sticky lg:top-8">
        <div class="space-y-4">
          <h1 class="text-3xl lg:text-4xl font-bold text-gray-900 leading-tight">Ø³Ø§Ø¹Ø© ÙƒØ±Ø¨ÙˆÙ† Ø£Ø³ÙˆØ¯ â€” Ø£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ©</h1>
          <p class="text-lg text-gray-600 leading-relaxed">
            Ø³Ø§Ø¹Ø© ÙØ§Ø®Ø±Ø© Ø¨ØªØµÙ…ÙŠÙ… ÙƒØ±Ø¨ÙˆÙ† Ø£Ø³ÙˆØ¯ Ø£Ù†ÙŠÙ‚ØŒ Ø£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ø¶Ø­Ø©ØŒ Ù…Ù‚Ø§ÙˆÙ…Ø© Ù„Ù„Ù…Ø§Ø¡ØŒ Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠ ÙˆØ§Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª Ø§Ù„Ø®Ø§ØµØ©.
          </p>
        </div>

        <!-- Ø§Ù„Ø³Ø¹Ø± -->
        <div class="price-card">
          <div class="flex items-center gap-4 mb-3">
            <span class="text-4xl lg:text-5xl font-bold text-white">400 Ø¬Ù†ÙŠÙ‡</span>
            <span class="text-xl text-white/70 line-through">550 Ø¬Ù†ÙŠÙ‡</span>
          </div>
          <div class="flex items-center gap-2 text-white/90 font-medium">
            <i class="fa-solid fa-tag"></i>
            <span>ÙˆÙØ± 150 Ø¬Ù†ÙŠÙ‡ (27% Ø®ØµÙ…)</span>
          </div>
        </div>

        <!-- Ø£Ø²Ø±Ø§Ø± -->
        <div class="space-y-4">
          <button id="addToCart" class="btn-primary w-full text-white py-5 px-8 rounded-2xl text-xl font-bold transition-all duration-300 transform hover:scale-105 hover:shadow-lg flex items-center justify-center gap-3">
            <i class="fa-solid fa-cart-shopping text-xl"></i>
            Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†
          </button>
          <div class="flex gap-4">
            <button id="addToFavorites" class="flex-1 border-2 border-gray-300 hover:border-red-500 text-gray-700 hover:text-red-500 py-3 px-6 rounded-xl font-medium transition-all duration-300 flex items-center justify-center gap-2" aria-label="Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙØ¶Ù„Ø©">
              <i class="fa-regular fa-heart"></i>
              Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©
            </button>
            <button id="shareProduct" class="flex-1 border-2 border-gray-300 hover:border-blue-500 text-gray-700 hover:text-blue-500 py-3 px-6 rounded-xl font-medium transition-all duration-300 flex items-center justify-center gap-2">
              <i class="fa-solid fa-share"></i>
              Ù…Ø´Ø§Ø±ÙƒØ©
            </button>
          </div>
        </div>


<!-- Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø© -->
<div id="orderPopup" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
  <div class="bg-white text-black p-8 rounded-3xl w-full max-w-lg lg:max-w-2xl shadow-2xl border border-gray-200 max-h-[90vh] overflow-y-auto">
    <div class="text-center mb-8">
      <h3 class="text-3xl font-bold text-gray-900 mb-2">
        <i class="fa-solid fa-cart-shopping ml-2 text-blue-600"></i>
        Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨
      </h3>
      <p class="text-gray-600">Ø§Ù…Ù„Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„Ø¥ØªÙ…Ø§Ù… Ø·Ù„Ø¨Ùƒ</p>
    </div>

    <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„Ø© -->
    <div id="statusMsg" class="mb-3 text-center text-sm font-medium text-gray-600" aria-live="polite"></div>

    <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ -->
    <div class="space-y-6 mb-8">
      <div class="grid lg:grid-cols-2 gap-6">
        <div class="relative">
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
          <input id="name" type="text" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„" class="w-full p-4 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400 pl-12 transition-all">
          <i class="fa-regular fa-user absolute left-4 top-11 text-gray-400" aria-hidden="true"></i>
        </div>

        <div class="relative">
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
          <div class="flex">
            <span class="px-4 flex items-center bg-gray-100 border-2 border-gray-200 border-l-0 rounded-r-xl text-gray-600 font-medium">+20</span>
            <input id="phone" type="tel" maxlength="11" placeholder="1012345678" class="flex-1 p-4 border-2 border-gray-200 rounded-l-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400 pl-12 transition-all">
            <i class="fa-solid fa-phone absolute left-4 top-11 text-gray-400" aria-hidden="true"></i>
          </div>
        </div>
      </div>

      <div class="relative">
        <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„</label>
        <input id="address" type="text" placeholder="Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©ØŒ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©ØŒ Ø§Ù„Ø´Ø§Ø±Ø¹ØŒ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¨Ù†Ù‰" class="w-full p-4 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400 pl-12 transition-all">
        <i class="fa-solid fa-location-dot absolute left-4 top-11 text-gray-400" aria-hidden="true"></i>
      </div>

      <div class="relative">
        <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ÙƒÙ…ÙŠØ©</label>
        <input id="quantity" type="number" min="1" value="1" class="w-full p-4 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 pl-12 transition-all">
        <i class="fa-solid fa-hashtag absolute left-4 top-11 text-gray-400" aria-hidden="true"></i>
      </div>
    </div>

    <!-- Ù‚Ø³Ù… Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† -->
    <div class="bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-2xl p-6 mb-8">
      <h4 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
        <i class="fa-solid fa-ticket text-purple-600 text-xl"></i>
        ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
      </h4>
      <div class="flex gap-3 mb-3">
        <div class="flex-1 relative">
          <input id="couponCode" type="text" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… Ø¥Ù† ÙˆØ¬Ø¯" class="w-full p-4 border-2 border-purple-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 placeholder-gray-400 pl-12 transition-all">
          <i class="fa-solid fa-tag absolute left-4 top-4 text-gray-400" aria-hidden="true"></i>
        </div>
        <button id="applyCouponBtn" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-4 rounded-xl font-semibold transition-all duration-300 hover:scale-105 flex items-center gap-2">
          <i class="fa-solid fa-check"></i>
          ØªØ·Ø¨ÙŠÙ‚
        </button>
      </div>
      <div id="couponMessage" class="text-sm hidden"></div>
    </div>

    <!-- Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¹Ø± -->
    <div class="bg-gradient-to-r from-gray-50 to-gray-100 border-2 border-gray-200 rounded-2xl p-6 mb-8">
      <h4 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
        <i class="fa-solid fa-calculator text-green-600"></i>
        Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨
      </h4>
      <div class="space-y-3">
        <div class="flex justify-between items-center">
          <span class="text-gray-600 font-medium">Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£ØµÙ„ÙŠ:</span>
          <span id="originalPrice" class="font-bold text-gray-800 text-lg">400 Ø¬Ù†ÙŠÙ‡</span>
        </div>
        <div id="discountRow" class="hidden flex justify-between items-center">
          <span class="text-green-600 font-medium">Ø§Ù„Ø®ØµÙ…:</span>
          <span id="discountAmount" class="font-bold text-green-600 text-lg">- 0 Ø¬Ù†ÙŠÙ‡</span>
        </div>
        <div class="border-t-2 border-gray-300 pt-3">
          <div class="flex justify-between items-center">
            <span class="text-xl font-bold text-gray-900">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</span>
            <span id="finalPrice" class="text-2xl font-bold text-green-600">400 Ø¬Ù†ÙŠÙ‡</span>
          </div>
        </div>
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mt-4">
          <p class="text-xs text-blue-800 flex items-center gap-2">
            <i class="fa-solid fa-info-circle"></i>
            <span>ØªÙƒÙ„ÙØ© Ø§Ù„Ø´Ø­Ù† Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯Ù‡Ø§ Ø¹Ù†Ø¯ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø­Ø³Ø¨ Ù…Ù†Ø·Ù‚ØªÙƒ</span>
          </p>
        </div>
      </div>
    </div>

    <div class="flex gap-4">
      <button id="closePopup" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 py-4 px-6 rounded-xl font-semibold transition-all duration-300 hover:scale-105 flex items-center justify-center gap-2">
        <i class="fa-solid fa-xmark"></i>
        Ø¥ØºÙ„Ø§Ù‚
      </button>
      <button id="sendOrder" class="flex-1 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white py-4 px-6 rounded-xl font-semibold transition-all duration-300 hover:scale-105 flex items-center justify-center gap-2 shadow-lg">
        <i class="fa-solid fa-rocket"></i>
        Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨
      </button>
    </div>
  </div>
</div>

<!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ -->
<div id="successMessage" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
  <div class="bg-white rounded-3xl p-8 lg:p-12 max-w-md lg:max-w-lg mx-4 text-center shadow-2xl border border-gray-200">
    <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
      <i class="fa-solid fa-check text-green-600 text-3xl"></i>
    </div>
    <h3 class="text-3xl lg:text-4xl font-bold text-gray-900 mb-4">ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­!</h3>
    <div class="text-lg text-gray-600 mb-8 leading-relaxed">
      <p class="mb-4">Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ Ø¹Ù„Ù‰ Ø«Ù‚ØªÙƒ Ø¨Ù†Ø§</p>
      <div class="bg-blue-50 border border-blue-200 rounded-xl p-4 text-sm">
        <h4 class="font-semibold text-blue-800 mb-2 flex items-center gap-2">
          <i class="fa-solid fa-info-circle"></i>
          Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ù‡Ù…Ø©:
        </h4>
        <ul class="space-y-2 text-blue-700">
          <li class="flex items-start gap-2">
            <i class="fa-solid fa-phone text-blue-600 mt-0.5"></i>
            <span>Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªÙØ§ØµÙŠÙ„</span>
          </li>
          <li class="flex items-start gap-2">
            <i class="fa-solid fa-shipping-fast text-blue-600 mt-0.5"></i>
            <span>Ø³Ø¹Ø± Ø§Ù„Ø´Ø­Ù† Ø³ÙŠØªÙ… Ø§Ø­ØªØ³Ø§Ø¨Ù‡ ÙˆØ§Ù„ØªØ£ÙƒÙŠØ¯ Ø¹Ù„ÙŠÙ‡ Ø¨Ø¹Ø¯ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø£Ø³Ø¹Ø§Ø± Ø¥ÙŠØ²ÙŠ Ø¨ÙˆÙƒØ³</span>
          </li>
          <li class="flex items-start gap-2">
            <i class="fa-solid fa-clock text-blue-600 mt-0.5"></i>
            <span>Ø§Ù„ØªÙˆØµÙŠÙ„ Ø®Ù„Ø§Ù„ 2-3 Ø£ÙŠØ§Ù… Ø¹Ù…Ù„ Ù…Ù† ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</span>
          </li>
        </ul>
      </div>
    </div>

    <div class="flex flex-col gap-4">
      <button id="trackOrderBtn" class="bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white px-8 py-4 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center gap-3">
        <i class="fa-solid fa-truck text-xl"></i>
        ØªØªØ¨Ø¹ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†
      </button>
      <button id="closeSuccessBtn" class="bg-gray-500 hover:bg-gray-600 text-white px-8 py-4 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center gap-3">
        <i class="fa-solid fa-check"></i>
        Ø¥ØºÙ„Ø§Ù‚
      </button>
    </div>
  </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
  import { getFirestore, collection, addDoc, query, where, getDocs, updateDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDeFqpa8MtVF5r3kKLfYZdM3EgPZCs3zeI",
    authDomain: "zamman-admin.firebaseapp.com",
    projectId: "zamman-admin",
    storageBucket: "zamman-admin.firebasestorage.app",
    messagingSenderId: "910842307850",
    appId: "1:910842307850:web:b7548b7a3323e1a19046f3",
    measurementId: "G-9MB7VF17G4"
  };
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Ø¨ÙŠØ§Ù†Ø§Øª CallMeBot
  const phone = "201026897739"; 
  const apikey = "5722213";

  // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ÙˆØ§ØªØ³Ø§Ø¨
  async function sendWhatsAppMessage(order) {
    const message = `ğŸ“¦ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯:
ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${order.name}
ğŸ“ Ø§Ù„ØªÙ„ÙŠÙÙˆÙ†: ${order.phone}
ğŸ  Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${order.address}
ğŸ›’ Ø§Ù„ÙƒÙ…ÙŠØ©: ${order.quantity}
â° Ø§Ù„ÙˆÙ‚Øª: ${order.orderTime}`;

    const url = `https://api.callmebot.com/whatsapp.php?phone=${phone}&text=${encodeURIComponent(message)}&apikey=${apikey}`;

    try {
      await fetch(url);
      console.log("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ÙˆØ§ØªØ³Ø§Ø¨");
    } catch (error) {
      console.error("âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„:", error);
    }
  }

  // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  const ordersRef = collection(db, "orders");
  onSnapshot(ordersRef, (snapshot) => {
    snapshot.docChanges().forEach((change) => {
      if (change.type === "added") {
        const newOrder = change.doc.data();
        console.log("ğŸ“¥ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯:", newOrder);
        sendWhatsAppMessage(newOrder);
      }
    });
  });
  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Firebase
  console.log("ğŸ”¥ Firebase ØªÙ… ØªÙ‡ÙŠØ¦ØªÙ‡ Ø¨Ù†Ø¬Ø§Ø­");
  console.log("ğŸ“Š Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø§Ù‡Ø²Ø©:", db.app.name);

  const popup = document.getElementById("orderPopup");
  const openBtn = document.getElementById("addToCart");
  const closeBtn = document.getElementById("closePopup");
  const sendBtn = document.getElementById("sendOrder");
  const statusMsg = document.getElementById("statusMsg");

  // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† ÙˆØ§Ù„Ø³Ø¹Ø±
  const unitPrice = 400; // Ø³Ø¹Ø± Ø§Ù„Ù‚Ø·Ø¹Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø©
  let appliedCoupon = null;
  let discountAmount = 0;
  let currentQuantity = 1;
  let totalBeforeDiscount = unitPrice; // Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø®ØµÙ…
  let finalPrice = unitPrice; // Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ



  openBtn.addEventListener("click", () => popup.classList.remove("hidden"));
  closeBtn.addEventListener("click", () => popup.classList.add("hidden"));

  // Ù…Ø±Ø§Ù‚Ø¨Ø© ØªØºÙŠÙŠØ± Ø§Ù„ÙƒÙ…ÙŠØ©
  document.getElementById("quantity").addEventListener("input", (e) => {
    currentQuantity = parseInt(e.target.value) || 1;
    if (currentQuantity < 1) {
      currentQuantity = 1;
      e.target.value = 1;
    }
    calculateTotalPrice();
  });

  // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†
  async function validateCoupon(couponCode) {
    try {
      const q = query(collection(db, "coupons"), where("code", "==", couponCode.toUpperCase()));
      const querySnapshot = await getDocs(q);

      if (querySnapshot.empty) {
        return { valid: false, message: "ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… ØºÙŠØ± ØµØ­ÙŠØ­" };
      }

      const couponDoc = querySnapshot.docs[0];
      const coupon = couponDoc.data();

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
      const now = new Date();
      const expiryDate = coupon.expiryDate.toDate();

      if (now > expiryDate) {
        return { valid: false, message: "Ø§Ù†ØªÙ‡Øª ØµÙ„Ø§Ø­ÙŠØ© ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…" };
      }

      return { valid: true, coupon: coupon };
    } catch (error) {
      console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†:", error);
      return { valid: false, message: "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†" };
    }
  }

  // Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø®ØµÙ…
  function calculateDiscount(coupon, originalPrice) {
    if (coupon.discountType === "percentage") {
      return (originalPrice * coupon.discountValue) / 100;
    } else if (coupon.discountType === "amount") {
      return Math.min(coupon.discountValue, originalPrice);
    }
    return 0;
  }

  // Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
  function calculateTotalPrice() {
    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø®ØµÙ… (Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© Ã— Ø§Ù„ÙƒÙ…ÙŠØ©)
    totalBeforeDiscount = unitPrice * currentQuantity;

    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø®ØµÙ… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
    if (appliedCoupon) {
      discountAmount = calculateDiscount(appliedCoupon, totalBeforeDiscount);
    } else {
      discountAmount = 0;
    }

    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
    finalPrice = totalBeforeDiscount - discountAmount;

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
    updatePriceDisplay();
  }

  // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±
  function updatePriceDisplay() {
    document.getElementById("originalPrice").textContent = `${totalBeforeDiscount} Ø¬Ù†ÙŠÙ‡`;
    document.getElementById("finalPrice").textContent = `${finalPrice} Ø¬Ù†ÙŠÙ‡`;

    if (discountAmount > 0) {
      document.getElementById("discountRow").classList.remove("hidden");
      document.getElementById("discountAmount").textContent = `- ${discountAmount} Ø¬Ù†ÙŠÙ‡`;
    } else {
      document.getElementById("discountRow").classList.add("hidden");
    }
  }

  // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†
  document.getElementById("applyCouponBtn").addEventListener("click", async () => {
    const couponCode = document.getElementById("couponCode").value.trim();
    const couponMessage = document.getElementById("couponMessage");
    const applyCouponBtn = document.getElementById("applyCouponBtn");

    if (!couponCode) {
      couponMessage.textContent = "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…";
      couponMessage.className = "text-sm text-red-500";
      couponMessage.classList.remove("hidden");
      return;
    }

    // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø²Ø± Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ù‚Ù‚
    applyCouponBtn.disabled = true;
    applyCouponBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin ml-1"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...';

    const validation = await validateCoupon(couponCode);

    if (validation.valid) {
      appliedCoupon = validation.coupon;
      calculateTotalPrice(); // Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ù…Ø¹ Ø§Ù„Ø®ØµÙ…

      couponMessage.textContent = `ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø®ØµÙ… Ø¨Ù†Ø¬Ø§Ø­! ÙˆÙØ±Øª ${discountAmount} Ø¬Ù†ÙŠÙ‡`;
      couponMessage.className = "text-sm text-green-600";
      couponMessage.classList.remove("hidden");

      // ØªØ¹Ø·ÙŠÙ„ Ø­Ù‚Ù„ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† ÙˆØ§Ù„Ø²Ø±
      document.getElementById("couponCode").disabled = true;
      applyCouponBtn.innerHTML = '<i class="fa-solid fa-check ml-1"></i> Ù…ÙØ·Ø¨Ù‚';
      applyCouponBtn.disabled = true;
      applyCouponBtn.className = "bg-green-600 text-white px-4 py-3 rounded-lg font-semibold";

    } else {
      couponMessage.textContent = validation.message;
      couponMessage.className = "text-sm text-red-500";
      couponMessage.classList.remove("hidden");

      applyCouponBtn.innerHTML = '<i class="fa-solid fa-check ml-1"></i> ØªØ·Ø¨ÙŠÙ‚';
      applyCouponBtn.disabled = false;
    }
  });

  // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†
  function resetCoupon() {
    appliedCoupon = null;
    calculateTotalPrice(); // Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¯ÙˆÙ† Ø®ØµÙ…

    document.getElementById("couponCode").value = "";
    document.getElementById("couponCode").disabled = false;
    document.getElementById("couponMessage").classList.add("hidden");

    const applyCouponBtn = document.getElementById("applyCouponBtn");
    applyCouponBtn.innerHTML = '<i class="fa-solid fa-check ml-1"></i> ØªØ·Ø¨ÙŠÙ‚';
    applyCouponBtn.disabled = false;
    applyCouponBtn.className = "bg-purple-600 hover:bg-purple-700 text-white px-6 py-4 rounded-xl font-semibold transition-all duration-300 hover:scale-105 flex items-center gap-2";
  }

  // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  async function testDatabaseConnection() {
    try {
      console.log("ğŸ” Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...");
      const testQuery = query(collection(db, "orders"));
      await getDocs(testQuery);
      console.log("âœ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­");
    } catch (error) {
      console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:", error);
      console.error("ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£:", error.message);
    }
  }

  // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
  calculateTotalPrice();

  // Ø§Ø®ØªØ¨Ø§Ø± Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  testDatabaseConnection();

  // ØªØ³Ø¬ÙŠÙ„ Ø²ÙŠØ§Ø±Ø© Ø§Ù„ØµÙØ­Ø© (Ø­Ù„ Ø¨Ø¯ÙŠÙ„)
  async function trackPageVisit() {
    try {
      // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø²ÙŠØ§Ø±Ø© ÙÙŠ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø²ÙˆØ§Ø±
      await addDoc(collection(db, "visitors"), {
        timestamp: new Date().toISOString(),
        userAgent: navigator.userAgent,
        referrer: document.referrer || 'direct',
        action: 'page_visit',
        page: 'index',
        screenResolution: `${screen.width}x${screen.height}`,
        language: navigator.language,
        platform: navigator.platform
      });
      console.log("ğŸ“Š ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø²ÙŠØ§Ø±Ø© Ø§Ù„ØµÙØ­Ø©");
    } catch (error) {
      console.warn("âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ³Ø¬ÙŠÙ„ Ø²ÙŠØ§Ø±Ø© Ø§Ù„ØµÙØ­Ø© ÙÙŠ Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù†ÙØµÙ„Ø©");
      // Ø§Ù„Ø­Ù„ Ø§Ù„Ø¨Ø¯ÙŠÙ„ Ø³ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø²ÙˆØ§Ø±
    }
  }

  // ØªØ³Ø¬ÙŠÙ„ Ø²ÙŠØ§Ø±Ø© Ø§Ù„ØµÙØ­Ø©
  trackPageVisit();

  // Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„Ø£Ø¯Ù…Ù†
async function sendWhatsAppNotification(order) {
    try {
      const message = `ğŸ”” Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† AQRAB!

ğŸ‘¤ Ø§Ù„Ø¹Ù…ÙŠÙ„: ${order.name}
ğŸ“± Ø§Ù„Ù‡Ø§ØªÙ: ${order.phone}
ğŸ“ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${order.address}
ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬: ${order.product}
ğŸ”¢ Ø§Ù„ÙƒÙ…ÙŠØ©: ${order.quantity}
ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleString('ar-EG')}

âœ… ÙŠØ±Ø¬Ù‰ Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…`;

      const encodedMessage = encodeURIComponent(message);
      const apiUrl = `https://api.callmebot.com/whatsapp.php?phone=201026897739&text=${encodedMessage}&apikey=5722213`;

      const response = await fetch(apiUrl);

      if (response.ok) {
        console.log("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­");
      } else {
        console.error("âŒ ÙØ´Ù„ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± ÙˆØ§ØªØ³Ø§Ø¨");
      }
    } catch (error) {
      console.error("Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± ÙˆØ§ØªØ³Ø§Ø¨:", error);
    }
  }
  // Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ù„Ù„Ø¹Ù…ÙŠÙ„ - Ù…Ø¹Ø·Ù„Ø©
  async function sendCustomerConfirmation(order) {
    // ØªÙ… ØªØ¹Ø·ÙŠÙ„ Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§ØªØ³Ø§Ø¨
    console.log("ØªÙ… ØªØ¹Ø·ÙŠÙ„ Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡");
    return;
  }

  // Ø¯Ø§Ù„Ø© Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ Ù…Ø¹ Ø®ÙŠØ§Ø± Ø§Ù„ØªØªØ¨Ø¹
  function showSuccessWithTracking(customerPhone) {
    // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
    document.getElementById("successMessage").classList.remove("hidden");

    // Ø­ÙØ¸ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„Ù„ØªØªØ¨Ø¹
    sessionStorage.setItem('customerPhone', customerPhone);

    // Ø¥ØºÙ„Ø§Ù‚ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ 10 Ø«ÙˆØ§Ù† (ÙˆÙ‚Øª Ø£Ø·ÙˆÙ„ Ù„Ø¥Ø¹Ø·Ø§Ø¡ ÙØ±ØµØ© Ù„Ù„ØªØªØ¨Ø¹)
    setTimeout(() => {
      document.getElementById("successMessage").classList.add("hidden");
    }, 10000);
  }

  // Ø¥ØºÙ„Ø§Ù‚ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
  document.getElementById("closeSuccessBtn").addEventListener("click", () => {
    document.getElementById("successMessage").classList.add("hidden");
  });

  // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„ØµÙØ­Ø© Ø§Ù„ØªØªØ¨Ø¹
  document.getElementById("trackOrderBtn").addEventListener("click", () => {
    const customerPhone = sessionStorage.getItem('customerPhone');
    if (customerPhone) {
      // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„ØµÙØ­Ø© Ø§Ù„ØªØªØ¨Ø¹ Ù…Ø¹ Ø§Ù„Ø±Ù‚Ù…
      window.location.href = `track-order.html?phone=${encodeURIComponent(customerPhone)}`;
    } else {
      // ÙÙŠ Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø±Ù‚Ù…ØŒ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ø¹Ø§Ø¯ÙŠ
      window.location.href = 'track-order.html';
    }
  });













  sendBtn.addEventListener("click", async () => {
    console.log("ğŸš€ Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨...");

    // Ù…Ø³Ø­ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
    statusMsg.innerHTML = '';
    statusMsg.classList.remove("text-red-500", "text-green-600");

    // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø²Ø± Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
    sendBtn.disabled = true;
    sendBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin ml-1"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...';

    const name = document.getElementById("name").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const address = document.getElementById("address").value.trim();
    const quantity = parseInt(document.getElementById("quantity").value.trim()) || 1;

    console.log("ğŸ“ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨:", { name, phone, address, quantity });

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    if (!name || !phone || !address || quantity < 1) {
      console.error("âŒ Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©:", {
        name: name || "ÙØ§Ø±Øº",
        phone: phone || "ÙØ§Ø±Øº",
        address: address || "ÙØ§Ø±Øº",
        quantity: quantity || "ÙØ§Ø±Øº"
      });
      statusMsg.innerHTML = '<i class="fa-solid fa-triangle-exclamation ml-1"></i> ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­';
      statusMsg.classList.add("text-red-500");

      // Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø±
      sendBtn.disabled = false;
      sendBtn.innerHTML = '<i class="fa-solid fa-rocket"></i> Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨';
      return;
    }

    // ØªÙ†Ø¸ÙŠÙ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ÙˆØ¥Ø¶Ø§ÙØ© 0 Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙÙ‚ÙˆØ¯
    let cleanPhone = phone.replace(/\s+/g, ''); // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ø³Ø§ÙØ§Øª
    if (cleanPhone.length === 10 && /^[1-9]/.test(cleanPhone)) {
      cleanPhone = '0' + cleanPhone; // Ø¥Ø¶Ø§ÙØ© 0 ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
      console.log("ğŸ”§ ØªÙ… Ø¥Ø¶Ø§ÙØ© 0 Ù„Ù„Ø±Ù‚Ù…:", cleanPhone);
    }

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ù…ØµØ±ÙŠ
    const phoneRegex = /^(010|011|012|015)[0-9]{8}$/;
    if (!phoneRegex.test(cleanPhone)) {
      console.error("âŒ Ø±Ù‚Ù… Ù‡Ø§ØªÙ ØºÙŠØ± ØµØ­ÙŠØ­:", cleanPhone);
      console.log("ğŸ“± Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ø®Ù„:", cleanPhone, "Ø§Ù„Ø·ÙˆÙ„:", cleanPhone.length);

      let errorMessage = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ù…ØµØ±ÙŠ ØµØ­ÙŠØ­';
      if (cleanPhone.length !== 11) {
        errorMessage += ` (ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 11 Ø±Ù‚Ù…ØŒ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${cleanPhone.length})`;
      } else if (!/^(010|011|012|015)/.test(cleanPhone)) {
        errorMessage += ' (ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 010 Ø£Ùˆ 011 Ø£Ùˆ 012 Ø£Ùˆ 015)';
      }

      statusMsg.innerHTML = `<i class="fa-solid fa-triangle-exclamation ml-1"></i> ${errorMessage}`;
      statusMsg.classList.add("text-red-500");

      // Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø±
      sendBtn.disabled = false;
      sendBtn.innerHTML = '<i class="fa-solid fa-rocket"></i> Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨';
      return;
    }

    console.log("âœ… Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ØµØ­ÙŠØ­:", cleanPhone);

    // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ù†Ø¸Ù
    const finalPhone = cleanPhone;

    try {
      const orderData = {
        product: "Ø³Ø§Ø¹Ø© ÙƒØ±Ø¨ÙˆÙ† Ø£Ø³ÙˆØ¯ â€” Ø£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ©",
        name,
        phone: "+2" + finalPhone,
        address,
        quantity: parseInt(quantity),
        unitPrice: unitPrice, // Ø³Ø¹Ø± Ø§Ù„Ù‚Ø·Ø¹Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø©
        totalBeforeDiscount: totalBeforeDiscount, // Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø®ØµÙ…
        price: finalPrice, // Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…
        date: new Date().toISOString(),
        status: "pending", // Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        couponCode: appliedCoupon ? appliedCoupon.code : "", // Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙØ§Ø±Øº
        discountApplied: discountAmount // Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø®ØµÙˆÙ…Ø© ÙØ¹Ù„ÙŠØ§Ù‹
      };

      console.log("ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ ÙÙŠ Firebase:", orderData);
      const docRef = await addDoc(collection(db, "orders"), orderData);
      console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­. Ù…Ø¹Ø±Ù Ø§Ù„Ø·Ù„Ø¨:", docRef.id);

      // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø¶Ø§ÙØ© Ø²Ø§Ø¦Ø± Ø¬Ø¯ÙŠØ¯ (Ù…Ø¹ Ø­Ù„ Ø¨Ø¯ÙŠÙ„)
      try {
        await addDoc(collection(db, "visitors"), {
          phone: finalPhone,
          timestamp: new Date().toISOString(),
          userAgent: navigator.userAgent,
          referrer: document.referrer || 'direct',
          action: 'order_placed'
        });
        console.log("ğŸ“Š ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø²Ø§Ø¦Ø± Ø¬Ø¯ÙŠØ¯");
      } catch (visitorError) {
        console.warn("âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø²Ø§Ø¦Ø± ÙÙŠ Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù†ÙØµÙ„Ø©");

        // Ø­Ù„ Ø¨Ø¯ÙŠÙ„: Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø§Ø¦Ø± Ù„Ù„Ø·Ù„Ø¨ Ù†ÙØ³Ù‡
        try {
          const visitorData = {
            userAgent: navigator.userAgent,
            referrer: document.referrer || 'direct',
            timestamp: new Date().toISOString(),
            screenResolution: `${screen.width}x${screen.height}`,
            language: navigator.language,
            platform: navigator.platform
          };

          // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø§Ø¦Ø±
          await updateDoc(docRef, {
            visitorInfo: visitorData
          });

          console.log("ğŸ“Š ØªÙ… Ø­ÙØ¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø§Ø¦Ø± Ù…Ø¹ Ø§Ù„Ø·Ù„Ø¨ ÙƒØ­Ù„ Ø¨Ø¯ÙŠÙ„");
        } catch (updateError) {
          console.warn("âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­ÙØ¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø§Ø¦Ø±:", updateError.message);
        }
      }

      // Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„Ø£Ø¯Ù…Ù†
      console.log("ğŸ“± Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„Ø£Ø¯Ù…Ù†...");
      try {
        await sendWhatsAppNotification({
          name,
          phone: "+20" + finalPhone,
          address,
          product: "Ø³Ø§Ø¹Ø© ÙƒØ±Ø¨ÙˆÙ† Ø£Ø³ÙˆØ¯ â€” Ø£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ©",
          quantity
        });
        console.log("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø£Ø¯Ù…Ù† Ø¨Ù†Ø¬Ø§Ø­");
      } catch (error) {
        console.warn("âš ï¸ ÙØ´Ù„ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø£Ø¯Ù…Ù†:", error);
      }

      // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ù„Ù„Ø¹Ù…ÙŠÙ„
      console.log("ğŸ“± Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ù„Ù„Ø¹Ù…ÙŠÙ„...");
      try {
        await sendCustomerConfirmation({
          name,
          phone: "+20" + finalPhone,
          product: "Ø³Ø§Ø¹Ø© ÙƒØ±Ø¨ÙˆÙ† Ø£Ø³ÙˆØ¯ â€” Ø£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ©",
          quantity
        });
        console.log("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­");
      } catch (error) {
        console.warn("âš ï¸ ÙØ´Ù„ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„:", error);
      }

      // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      popup.classList.add("hidden");

      // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ Ù…Ø¹ Ø®ÙŠØ§Ø± Ø§Ù„ØªØªØ¨Ø¹
      console.log("ğŸ‰ Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­");
      showSuccessWithTracking(finalPhone);

      // Ù…Ø³Ø­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
      document.getElementById("name").value = "";
      document.getElementById("phone").value = "";
      document.getElementById("address").value = "";
      document.getElementById("quantity").value = "1";

      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†
      resetCoupon();

      // Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø±
      sendBtn.disabled = false;
      sendBtn.innerHTML = '<i class="fa-solid fa-rocket"></i> Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨';

      console.log("âœ… ØªÙ… Ø¥ÙƒÙ…Ø§Ù„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­");
    } catch (error) {
      console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨:", error);
      console.error("ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£:", error.message);
      console.error("ÙƒÙˆØ¯ Ø§Ù„Ø®Ø·Ø£:", error.code);

      // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      popup.classList.add("hidden");

      // ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø®Ø·Ø£ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù…Ù†Ø§Ø³Ø¨Ø©
      let errorMessage = "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰";

      if (error.code === 'permission-denied') {
        errorMessage = "Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙ„Ø§Ø­ÙŠØ§Øª ÙƒØ§ÙÙŠØ©. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase";
      } else if (error.code === 'unavailable') {
        errorMessage = "Ø§Ù„Ø®Ø¯Ù…Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹";
      } else if (error.message.includes('network')) {
        errorMessage = "Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„";
      }

      // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£
      statusMsg.innerHTML = `<i class="fa-solid fa-circle-xmark ml-1"></i> ${errorMessage}`;
      statusMsg.classList.add("text-red-500");
      statusMsg.classList.remove("text-green-600");

      // Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø±
      sendBtn.disabled = false;
      sendBtn.innerHTML = '<i class="fa-solid fa-rocket"></i> Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨';

      // Ø¥Ø®ÙØ§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ Ø¨Ø¹Ø¯ 8 Ø«ÙˆØ§Ù†
      setTimeout(() => {
        statusMsg.innerHTML = '';
        statusMsg.classList.remove("text-red-500");
      }, 8000);
    }
  });

  // ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±
  const mainImage = document.getElementById('mainImage');
  document.querySelectorAll('.thumb').forEach(img => {
    img.addEventListener('click', () => {
      mainImage.src = img.src;
    });
  });

  // Ø²Ø± Ø§Ù„Ù…ÙØ¶Ù„Ø©
  let isFavorite = localStorage.getItem('favorite_watch') === 'true';
  const favoriteBtn = document.getElementById('addToFavorites');

  function updateFavoriteButton() {
    if (isFavorite) {
      favoriteBtn.innerHTML = '<i class="fa-solid fa-heart text-red-500"></i> ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©';
      favoriteBtn.className = 'flex-1 border-2 border-red-500 bg-red-50 text-red-500 py-3 px-6 rounded-xl font-medium transition-all duration-300 flex items-center justify-center gap-2';
    } else {
      favoriteBtn.innerHTML = '<i class="fa-regular fa-heart"></i> Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©';
      favoriteBtn.className = 'flex-1 border-2 border-gray-300 hover:border-red-500 text-gray-700 hover:text-red-500 py-3 px-6 rounded-xl font-medium transition-all duration-300 flex items-center justify-center gap-2';
    }
  }

  favoriteBtn.addEventListener('click', () => {
    isFavorite = !isFavorite;
    localStorage.setItem('favorite_watch', isFavorite);
    updateFavoriteButton();

    // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø©
    const message = isFavorite ? 'ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ù„Ù„Ù…ÙØ¶Ù„Ø©! â¤ï¸' : 'ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©';
    showNotification(message, isFavorite ? 'success' : 'info');
  });

  // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø± Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
  updateFavoriteButton();

  // Ø²Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
  document.getElementById('shareProduct').addEventListener('click', () => {
    const productData = {
      title: 'Ø³Ø§Ø¹Ø© ÙƒØ±Ø¨ÙˆÙ† Ø£Ø³ÙˆØ¯ â€” Ø£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ©',
      text: 'Ø³Ø§Ø¹Ø© ÙØ§Ø®Ø±Ø© Ø¨ØªØµÙ…ÙŠÙ… ÙƒØ±Ø¨ÙˆÙ† Ø£Ø³ÙˆØ¯ Ø£Ù†ÙŠÙ‚ØŒ Ø£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ø¶Ø­Ø©ØŒ Ù…Ù‚Ø§ÙˆÙ…Ø© Ù„Ù„Ù…Ø§Ø¡',
      url: window.location.href
    };

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¯Ø¹Ù… Web Share API
    if (navigator.share) {
      navigator.share(productData)
        .then(() => showNotification('ØªÙ… Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­! ğŸ“¤', 'success'))
        .catch((error) => {
          console.log('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©:', error);
          fallbackShare();
        });
    } else {
      fallbackShare();
    }
  });

  // Ù…Ø´Ø§Ø±ÙƒØ© Ø¨Ø¯ÙŠÙ„Ø© Ù„Ù„Ù…ØªØµÙØ­Ø§Øª Ø§Ù„ØªÙŠ Ù„Ø§ ØªØ¯Ø¹Ù… Web Share API
  function fallbackShare() {
    const shareData = {
      title: 'Ø³Ø§Ø¹Ø© ÙƒØ±Ø¨ÙˆÙ† Ø£Ø³ÙˆØ¯ â€” Ø£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ©',
      text: `Ø³Ø§Ø¹Ø© ÙØ§Ø®Ø±Ø© Ø¨ØªØµÙ…ÙŠÙ… ÙƒØ±Ø¨ÙˆÙ† Ø£Ø³ÙˆØ¯ Ø£Ù†ÙŠÙ‚ØŒ Ø£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ø¶Ø­Ø©ØŒ Ù…Ù‚Ø§ÙˆÙ…Ø© Ù„Ù„Ù…Ø§Ø¡ - Ø§Ù„Ø³Ø¹Ø±: ${unitPrice} Ø¬Ù†ÙŠÙ‡`,
      url: window.location.href
    };

    // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø§ÙØ°Ø© Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ø®ØµØµØ©
    const shareModal = document.createElement('div');
    shareModal.className = 'fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4';
    shareModal.innerHTML = `
      <div class="bg-white rounded-2xl p-6 max-w-md w-full">
        <h3 class="text-xl font-bold mb-4 text-center">Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬</h3>
        <div class="space-y-3">
          <button onclick="shareToWhatsApp()" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 px-4 rounded-xl font-medium transition flex items-center justify-center gap-2">
            <i class="fa-brands fa-whatsapp text-xl"></i>
            Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
          </button>
          <button onclick="shareToFacebook()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-xl font-medium transition flex items-center justify-center gap-2">
            <i class="fa-brands fa-facebook text-xl"></i>
            Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ø¨Ø± ÙÙŠØ³Ø¨ÙˆÙƒ
          </button>
          <button onclick="copyLink()" class="w-full bg-gray-600 hover:bg-gray-700 text-white py-3 px-4 rounded-xl font-medium transition flex items-center justify-center gap-2">
            <i class="fa-solid fa-copy text-xl"></i>
            Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·
          </button>
          <button onclick="closeShareModal()" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 py-3 px-4 rounded-xl font-medium transition">
            Ø¥ØºÙ„Ø§Ù‚
          </button>
        </div>
      </div>
    `;

    document.body.appendChild(shareModal);

    // Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ù„Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¹Ø§Ù…Ø©
    window.shareToWhatsApp = () => {
      const text = encodeURIComponent(`${shareData.title}\n\n${shareData.text}\n\n${shareData.url}`);
      window.open(`https://wa.me/?text=${text}`, '_blank');
      closeShareModal();
    };

    window.shareToFacebook = () => {
      const url = encodeURIComponent(shareData.url);
      window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
      closeShareModal();
    };

    window.copyLink = () => {
      navigator.clipboard.writeText(shareData.url).then(() => {
        showNotification('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·! ğŸ“‹', 'success');
        closeShareModal();
      }).catch(() => {
        // fallback Ù„Ù„Ù…ØªØµÙØ­Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
        const textArea = document.createElement('textarea');
        textArea.value = shareData.url;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        showNotification('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·! ğŸ“‹', 'success');
        closeShareModal();
      });
    };

    window.closeShareModal = () => {
      document.body.removeChild(shareModal);
    };
  }

  // Ø¯Ø§Ù„Ø© Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
  function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500';

    notification.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300`;
    notification.textContent = message;

    document.body.appendChild(notification);

    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
    setTimeout(() => {
      notification.classList.remove('translate-x-full');
    }, 100);

    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†
    setTimeout(() => {
      notification.classList.add('translate-x-full');
      setTimeout(() => {
        if (document.body.contains(notification)) {
          document.body.removeChild(notification);
        }
      }, 300);
    }, 3000);
  }

  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ù†Ø© ÙÙŠ Ø§Ù„ÙÙˆØªØ±
  document.getElementById('y').textContent = new Date().getFullYear();

  // Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø²Ø§Ø¦Ø±
  async function recordVisitor() {
    try {
      // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ø±Ù ÙØ±ÙŠØ¯ Ù„Ù„Ø²Ø§Ø¦Ø± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… localStorage
      let visitorId = localStorage.getItem('visitorId');

      if (!visitorId) {
        // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ø±Ù Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø²Ø§Ø¦Ø±
        visitorId = 'visitor_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('visitorId', visitorId);

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø²Ø§Ø¦Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        await addDoc(collection(db, "visitors"), {
          visitorId: visitorId,
          firstVisit: new Date().toISOString(),
          userAgent: navigator.userAgent,
          language: navigator.language,
          timestamp: new Date()
        });

        console.log("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø²Ø§Ø¦Ø± Ø¬Ø¯ÙŠØ¯:", visitorId);
      } else {
        // ØªØ­Ø¯ÙŠØ« Ø¢Ø®Ø± Ø²ÙŠØ§Ø±Ø© Ù„Ù„Ø²Ø§Ø¦Ø± Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯
        const q = query(collection(db, "visitors"), where("visitorId", "==", visitorId));
        const querySnapshot = await getDocs(q);

        if (!querySnapshot.empty) {
          const docRef = querySnapshot.docs[0].ref;
          await updateDoc(docRef, {
            lastVisit: new Date().toISOString(),
            visitCount: increment(1)
          });
        }
      }
    } catch (error) {
      console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø²Ø§Ø¦Ø±:", error);
    }
  }

  // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø²Ø§Ø¦Ø± Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
  recordVisitor();

</script>



      <!-- Ø¥Ø´Ø¹Ø§Ø± -->
      <p id="notification" class="text-black font-medium hidden">
        <i class="fa-solid fa-circle-check ml-1"></i> ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©!
      </p>

        <!-- Ù…ÙˆØ§ØµÙØ§Øª -->
        <div class="bg-white border border-gray-200 rounded-2xl p-6">
          <h3 class="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
            <i class="fa-solid fa-star text-yellow-500"></i>
            Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª
          </h3>
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
            <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
              <i class="fa-solid fa-circle-check text-green-600 text-lg"></i>
              <span class="text-gray-700 font-medium">Ù…Ø§Ø¯Ø© Ø§Ù„Ø¥Ø·Ø§Ø±: ÙƒØ±Ø¨ÙˆÙ† ÙØ§Ø®Ø±</span>
            </div>
            <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
              <i class="fa-solid fa-circle-check text-green-600 text-lg"></i>
              <span class="text-gray-700 font-medium">Ø£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ø¶Ø­Ø©</span>
            </div>
            <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
              <i class="fa-solid fa-circle-check text-green-600 text-lg"></i>
              <span class="text-gray-700 font-medium">Ù…Ù‚Ø§ÙˆÙ…Ø© Ù„Ù„Ù…Ø§Ø¡ 50 Ù…ØªØ±</span>
            </div>
            <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
              <i class="fa-solid fa-circle-check text-green-600 text-lg"></i>
              <span class="text-gray-700 font-medium">Ø¶Ù…Ø§Ù† Ø³Ù†Ø© ÙƒØ§Ù…Ù„Ø©</span>
            </div>
          </div>
        </div>

        <!-- Ø´Ø­Ù† -->
        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-2xl p-6">
          <div class="flex items-start gap-4">
            <div class="bg-blue-100 p-3 rounded-full">
              <i class="fa-solid fa-truck text-blue-600 text-xl"></i>
            </div>
            <div>
              <h4 class="font-bold text-gray-900 mb-2">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø­Ù† ÙˆØ§Ù„ØªÙˆØµÙŠÙ„</h4>
              <ul class="space-y-2 text-gray-700">
                <li class="flex items-center gap-2">
                  <i class="fa-solid fa-clock text-blue-600"></i>
                  <span>Ø§Ù„ØªÙˆØµÙŠÙ„ Ø®Ù„Ø§Ù„ 2-3 Ø£ÙŠØ§Ù… Ø¹Ù…Ù„</span>
                </li>
                <li class="flex items-center gap-2">
                  <i class="fa-solid fa-money-bill text-green-600"></i>
                  <span>Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</span>
                </li>
                <li class="flex items-center gap-2">
                  <i class="fa-solid fa-shipping-fast text-purple-600"></i>
                  <span>Ø³Ø¹Ø± Ø§Ù„Ø´Ø­Ù† ÙŠØªÙ… Ø§Ø­ØªØ³Ø§Ø¨Ù‡ ÙˆØ§Ù„ØªØ£ÙƒÙŠØ¯ Ø¹Ù„ÙŠÙ‡ Ø¨Ø¹Ø¯ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø£Ø³Ø¹Ø§Ø± Ø¥ÙŠØ²ÙŠ Ø¨ÙˆÙƒØ³</span>
                </li>
                <li class="flex items-center gap-2">
                  <i class="fa-solid fa-undo text-orange-600"></i>
                  <span>Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ Ø®Ù„Ø§Ù„ 14 ÙŠÙˆÙ…</span>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <style>
  /* Ø§Ù„ÙƒØ±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù…Ø© */
  #chat-ball {
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 60px;
    height: 60px;
    background: linear-gradient(45deg, #000000, #333333);
    border-radius: 50%;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 28px;
    z-index: 9999;
    transition: transform 0.2s ease;
    text-decoration: none;
    position: fixed;
  }

  #chat-ball:hover {
    transform: scale(1.2);
  }
</style>

<!-- Ø§Ù„ÙƒØ±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù…Ø© -->
<div id="chat-ball-container">
  <a href="https://3qrabchat.streamlit.app/" target="_blank" id="chat-ball">ğŸ’¬</a>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const chatBall = document.getElementById("chat-ball");
    let isDragging = false, offsetX, offsetY;

    chatBall.addEventListener("mousedown", (e) => {
      isDragging = true;
      offsetX = e.clientX - chatBall.getBoundingClientRect().left;
      offsetY = e.clientY - chatBall.getBoundingClientRect().top;
      e.preventDefault();
    });

    document.addEventListener("mousemove", (e) => {
      if (isDragging) {
        chatBall.style.left = e.clientX - offsetX + "px";
        chatBall.style.top = e.clientY - offsetY + "px";
      }
    });

    document.addEventListener("mouseup", () => {
      isDragging = false;
    });
  });
</script>

  </main>

  <!-- ÙÙˆØªØ± -->
  <footer class="bg-gradient-to-r from-gray-900 to-black text-white mt-16">
    <div class="max-w-7xl mx-auto px-4 py-12">
      <div class="grid lg:grid-cols-3 gap-8 mb-8">
        <div>
          <h3 class="text-2xl font-bold mb-4 flex items-center gap-2">
            <i class="fa-solid fa-clock text-yellow-400"></i>
            AQRAB
          </h3>
          <p class="text-gray-300 text-lg leading-relaxed mb-6">Ù…ØªØ¬Ø±Ùƒ Ø§Ù„Ù…ÙˆØ«ÙˆÙ‚ Ù„Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„ÙØ§Ø®Ø±Ø© ÙˆØ§Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø§Ù„Ø¹ØµØ±ÙŠØ©. Ù†Ù‚Ø¯Ù… Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø£Ø¹Ù„Ù‰ Ø¬ÙˆØ¯Ø© ÙˆØ£ÙØ¶Ù„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±.</p>
        </div>

        <div>
          <h4 class="text-xl font-bold mb-4 text-yellow-400">Ø±ÙˆØ§Ø¨Ø· Ø³Ø±ÙŠØ¹Ø©</h4>
          <ul class="space-y-3">
            <li><a href="#" class="text-gray-300 hover:text-white transition-colors duration-300 flex items-center gap-2"><i class="fa-solid fa-chevron-left text-xs"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
            <li><a href="track-order.html" class="text-gray-300 hover:text-white transition-colors duration-300 flex items-center gap-2"><i class="fa-solid fa-chevron-left text-xs"></i> ØªØªØ¨Ø¹ Ø§Ù„Ø·Ù„Ø¨</a></li>
            <li><a href="admin.html" class="text-gray-300 hover:text-white transition-colors duration-300 flex items-center gap-2"><i class="fa-solid fa-chevron-left text-xs"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a></li>
          </ul>
        </div>

        <div>
          <h4 class="text-xl font-bold mb-4 text-yellow-400">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h4>
          <div class="space-y-4">
            <div class="flex items-center gap-3">
              <div class="w-8 h-8 bg-green-600 rounded-full flex items-center justify-center">
                <i class="fa-brands fa-whatsapp text-sm"></i>
              </div>
              <span class="text-gray-300">01026897739</span>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-8 h-8 bg-red-600 rounded-full flex items-center justify-center">
                <i class="fa-regular fa-envelope text-sm"></i>
              </div>
              <span class="text-gray-300">ehab.hussein.dev@gmail.com</span>
            </div>
          </div>
        </div>
      </div>

      <div class="border-t border-gray-700 pt-8 text-center">
        <p class="text-gray-400">
          Â© <span id="y"></span> AQRAB. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.
        </p>
      </div>
    </div>
  </footer>


 
</body>
</html>
